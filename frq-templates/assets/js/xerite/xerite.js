
//colors array is fake data array,just fetch your api here and assign data to colors,also change properties' name based on data
const colors = {
    2: {
        id: 2,
        bcgColor: "#90C474",
        title: "Lənkəran-Astara",
        male_value: 2200,
        male_percent: 50,
        female_value: 2200,
        female_percent: 50,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Lənkəran-Astara iqtisadi rayonu",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Lənkəran",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Astara",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Masallı",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Masallı",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    4: {
        id: 4,
        bcgColor: "#D2DF8A",
        title: "Qazax-Tovuz",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Qazax-Tovuz iqtisadi rayonu",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Qazax",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Tovuz",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Şəmkir",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    6: {
        id: 6,
        bcgColor: "#EFDB85",
        title: "Şərqi Zəngəzur",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Şərqi Zəngəzur iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Zəngilan",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Cəbrayıl",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Qubadlı",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    8: {
        id: 8,
        bcgColor: "#F19CC2",
        title: "Qarabağ",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Qarabağ iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şuşa",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Laçın",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Kəlbəcər",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    10: {
        id: 10,
        bcgColor: "#F8CCDD",
        title: "Gəncə-Daşkən",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Gəncə-Daşkən iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Gəncə",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Daşkəsən",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Kəlbəcər",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    12: {
        id: 12,
        bcgColor: "#F19CC2",
        title: "Şəki-Zaqatala",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Şəki-Zaqatala iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şəki",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Zaqatala",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Qax",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    14: {
        id: 14,
        bcgColor: "#B7D172",
        title: "Mərkəzi Aran",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Mərkəzi Aran iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Yevlax",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Bərdə",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Ağdam",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    16: {
        id: 16,
        bcgColor: "#F2BF5F",
        title: "Mil-Muğan",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Mil-Muğan iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Lerik",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Astara",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Cəlilabad",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    18: {
        id: 18,
        bcgColor: "#9BA8D5",
        title: "Şirvan-Salyan",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Şirvan-Salyan iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şirvan",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Salyan",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Hacıqabul",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    22: {
        id: 22,
        bcgColor: "#0574BA",
        title: "Bakı",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Bakı iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas.",

        cities: [
            {
                title: "Bakı",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Sumqayıt",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Gəncə",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    20: {
        id: 20,
        bcgColor: "#F19CC2",
        title: "Abşeron-Xızı",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Abşeron-Xızı iqsadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Abşeron",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Xızı",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Quba",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    26: {
        id: 26,
        bcgColor: "#DDE38A",
        title: "Dağlıq-Şırvan",
        male_value: 2200,
        male_percent: 20,
        female_value: 2200,
        female_percent: 80,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 20,
        standart_ttk_value: 1200,
        standart_ttk_percent: 80,
        title2: "Dağlıq-Şırvan iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şamaxı",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Quba",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "İsmayıllı",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    28: {
        id: 28,
        bcgColor: "#F2D974",
        title: "Quba-Xaçmaz",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Quba-Xaçmaz iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Quba",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Xaçmaz",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Qusar",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    },
    30: {
        id: 30,
        bcgColor: "#DBE390",
        title: "Naxçıvan",
        male_value: 2200,
        male_percent: 44,
        female_value: 2200,
        female_percent: 56,
        sosial_ttk_value: 1244,
        sosial_ttk_percent: 44,
        standart_ttk_value: 1200,
        standart_ttk_percent: 56,
        title2: "Naxçıvan iqtisadi rayonu",

        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Naxçıvan",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Şərur",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            },
            {
                title: "Ordubad",
                male_value: 2200,
                male_percent: 44,
                female_value: 2200,
                female_percent: 56,
                sosial_ttk_value: 1244,
                sosial_ttk_percent: 44,
                standart_ttk_value: 1200,
                standart_ttk_percent: 56,
            }
        ]
    }
};



document.addEventListener('DOMContentLoaded', () => {
    const objectElement = document.getElementById('mySvg');
    const infoBox = document.getElementById('info-box');
    const detailsOverlay = document.querySelector('.details-overlay');
    const detailsContent = document.querySelector('.details-content');
    let currentHighlightedElement = null;

    const svgDoc = objectElement.contentDocument;
    console.log(svgDoc);
    // objectElement.addEventListener('load', () => {
        if (svgDoc) {
            const clickableAreas = svgDoc.querySelectorAll('.clickable-area');

            clickableAreas.forEach(area => {
                
                if (window.innerWidth > 992) {
                    area.addEventListener('mousemove', (event) => {
                        event.preventDefault();
                        let id = area.getAttribute('data-id');
                        id = parseInt(id, 10);

                        if (id % 2 !== 0) {
                            id++;
                        }

                        const elements = svgDoc.querySelectorAll(`.clickable-area[data-id='${id}']`);

                        if (elements && id) {
                            if (currentHighlightedElement && currentHighlightedElement !== elements) {
                                resetElement(currentHighlightedElement);
                            }

                            highlightElement(elements, id);

                            currentHighlightedElement = elements;

                            showInfoBox(elements, id, event);
                        }
                    });
                }
                else {
                    area.addEventListener('click', (event) => {
                        event.preventDefault();
                        let id = area.getAttribute('data-id');
                        id = parseInt(id, 10);

                        if (id % 2 !== 0) {
                            id++;
                        }

                        const elements = svgDoc.querySelectorAll(`.clickable-area[data-id='${id}']`);

                        if (elements && id) {
                            if (currentHighlightedElement && currentHighlightedElement !== elements) {
                                resetElement(currentHighlightedElement);
                            }

                            highlightElement(elements, id);

                            currentHighlightedElement = elements;

                            showInfoBox(elements, id, event);
                        }
                    })

                }

                area.addEventListener('mouseout', (event) => {
                    if (!infoBox.matches(':hover')) {
                        hideInfoBox();
                        if (currentHighlightedElement) {
                            resetElement(currentHighlightedElement);
                            currentHighlightedElement = null;
                        }
                    }
                });
            });

            infoBox.addEventListener('mouseover', () => {
                infoBox.style.display = 'block';
            });

            infoBox.addEventListener('mouseout', () => {
                if (!detailsOverlay.matches(':hover') && !infoBox.matches(':hover')) {
                    hideInfoBox();
                    if (currentHighlightedElement) {
                        resetElement(currentHighlightedElement);
                        currentHighlightedElement = null;
                    }
                }
            });
        }
    // });

    function highlightElement(elements, id) {
        const shadowColor = '#0005185';
        elements.forEach(item => {
            item.style.fill = colors[id]?.bcgColor;
            item.style.filter = `drop-shadow(0 0 10px ${shadowColor})`;
            item.style.transform = 'translate(5px, -3px)';
        });
    }

    function resetElement(elements) {
        if (elements) {
            elements.forEach(item => {
                if (item.getAttribute("data-id") % 2 == 0) {
                    item.style.fill = '#E9F5FF';
                    item.style.filter = 'none';
                    item.style.transform = 'none';
                }
            });
        }
        hideInfoBox();
    }

    function showInfoBox(elements, id, event) {

        infoBox.style.display = 'block';

        const rect = elements[0].getBoundingClientRect();
        const viewportWidth = window.innerWidth;
        const viewportHeight = window.innerHeight;
    
        let top = rect.top - infoBox.offsetHeight / 2;
        let left = rect.left + window.scrollX + rect.width / 2 - infoBox.offsetWidth / 2;
    
        if (left + infoBox.offsetWidth > viewportWidth) {
            left = viewportWidth - infoBox.offsetWidth - 20; 
        }
        if (left < 0) {
            left = 20; 
        }
        if (top + infoBox.offsetHeight > viewportHeight) {
            top = viewportHeight - infoBox.offsetHeight - 20; 
        }
        if (top < 0) {
            top = 20; 
        }
    
        if (window.innerWidth > 1800) {
            top = event.clientY - 250;
            left = event.clientX - 150;
        }
        else if (window.innerWidth > 1600) {
            top = event.clientY - 260;
            left = event.clientX - 170;
        }
        else if (window.innerWidth > 1400) {
            top = event.clientY - 260;
            left = event.clientX - 100;
        }
        else if (window.innerWidth > 1000) {
            top = event.clientY - 250;
            left = event.clientX - 100;
        } 
        else if (window.innerWidth > 480) {
            top = event.clientY - 260;
            left = event.clientX - 100;
        }
       
        else if (window.innerWidth > 400) {
            top = event.clientY - 160;
            left = event.clientX - 100;
        }
        else if (window.innerWidth > 380) {
            top = event.clientY - 160;
            left = event.clientX - 100;
        }
        else if (window.innerWidth > 361) {
            top = event.clientY - 180;
            left = event.clientX - 100;
        }
        else if (window.innerWidth > 350) {
            top = event.clientY - 160;
            left = event.clientX - 100;
        }
        else if (window.innerWidth > 330) {
            top = event.clientY - 170;
            left = event.clientX - 100;
        }
        else {
            top = event.clientY - 120;
            left = event.clientX - 40;
        }
    
        if (left + infoBox.offsetWidth > viewportWidth) {
            left = viewportWidth - infoBox.offsetWidth - 20;
        }
        if (left < 0) {
            left = 20;
        }
       
    
        infoBox.style.top = `${top}px`;
        infoBox.style.left = `${left}px`;



        infoBox.innerHTML = `
            <h5>${colors[id]?.title}</h5>
            <div class="info-text">
                Kişi:
                <div>
                <img src="./frq-templates/assets/img/xerite/menicon.svg" alt="">

                        ${colors[id]?.male_percent}%
                </div>
            </div>
            <div class="info-text">
                Qadın:
                <div>
                    <img src="./frq-templates/assets/img/xerite/womenicon.svg" alt="">
                    ${colors[id]?.female_percent}%
                </div>
            </div>
            <div class="info-text">
                Sosial TTK:
                <div>
                    ${colors[id]?.sosial_ttk_value}
                    <svg width="400px" viewBox="0 0 40 40" class="circular-chart">
                    <!-- Background Circle -->
                    <path
                        class="background"
                        d="M18 2.0845
                           a 15.9155 15.9155 0 0 1 0 31.831
                           a 15.9155 15.9155 0 0 1 0 -31.831"
                        pathLength="100"
                    />
                    <!-- Progress Circle -->
                    ${getChart(colors[id]?.sosial_ttk_percent,
            `<path id="progress-circle" class="progress" 
                            d="M18 2.0845a 15.9155 15.9155 0 0 1 0 31.831
                               a 15.9155 15.9155 0 0 1 0 -31.831"
                            pathLength="100" />`,
            '#E73B8E'
        )}
                </svg>
                             </div>
            </div>
            <div class="info-text">
                Standart TTK:
                <div>
                    ${colors[id]?.standart_ttk_value}
                    <svg width="400px" viewBox="0 0 40 40" class="circular-chart">
                    <!-- Background Circle -->
                    <path
                        class="background"
                        d="M18 2.0845
                           a 15.9155 15.9155 0 0 1 0 31.831
                           a 15.9155 15.9155 0 0 1 0 -31.831"
                        pathLength="100"
                    />
                    <!-- Progress Circle -->
                    ${getChart(colors[id]?.standart_ttk_percent,
            `<path id="progress-circle" class="progress" 
                            d="M18 2.0845a 15.9155 15.9155 0 0 1 0 31.831
                               a 15.9155 15.9155 0 0 1 0 -31.831"
                            pathLength="100" />`,
            '#0059A7'
        )}
                </svg>                </div>
            </div>
            <button class="modal-more-btn" onclick="openDetailModal(${colors[id].id})">Ətraflı</button>
        `;
    }

    function hideInfoBox() {
        infoBox.style.display = 'none';
    }

    window.openDetailModal = function (ID) {
        hideInfoBox();

        detailsContent.innerHTML = `
        <div class="details-content-top">
      <div class="details-content-article">
          <h2>${colors[ID].title2} </h2>
          <p>${colors[ID].about}</p>
      </div>
      <div class="map-details-content-statistic-main">
          <div class="map-details-content-statistic-each">
          <div >
          <h3>${colors[ID].male_value}</h3>
          <img src="./frq-templates/assets/img/xerite/menicon.svg" alt="">
          </div>   
          <div class="info-text">
          <p>Kişi:</p>
              <span>${colors[ID].male_percent}%</span></div>
          </div>
          <div class="map-details-content-statistic-each">
             <div>
             <h3>${colors[ID].sosial_ttk_value}</h3>
             <svg width="400px" viewBox="0 0 40 40" class="circular-chart">
             <!-- Background Circle -->
             <path
                 class="background"
                 d="M18 2.0845
                    a 15.9155 15.9155 0 0 1 0 31.831
                    a 15.9155 15.9155 0 0 1 0 -31.831"
                 pathLength="100"
             />
             <!-- Progress Circle -->
             ${getChart(colors[ID]?.sosial_ttk_percent,
     `<path id="progress-circle" class="progress" 
                     d="M18 2.0845a 15.9155 15.9155 0 0 1 0 31.831
                        a 15.9155 15.9155 0 0 1 0 -31.831"
                     pathLength="100" />`,
     '#E73B8E'
 )}
         </svg>            </div> 
            <div class="info-text">
            <p>Sosial TTK:</p>
              <span class="female-color">${colors[ID].sosial_ttk_percent}%</span>
            </div>
          </div>
          <div class="map-details-content-statistic-each">
           <div>
           <h3>${colors[ID].female_value}</h3>
              <img src="./frq-templates/assets/img/xerite/womenicon.svg" alt="">
              
           </div>   
          <div class="info-text">
          <p>Qadın:</p>
              <span>${colors[ID].female_percent}%</span>
          </div>
          </div>
          <div class="map-details-content-statistic-each">
          <div>
          <h3>${colors[ID].standart_ttk_value}</h3>
          <svg width="400px" viewBox="0 0 40 40" class="circular-chart">
          <!-- Background Circle -->
          <path
              class="background"
              d="M18 2.0845
                 a 15.9155 15.9155 0 0 1 0 31.831
                 a 15.9155 15.9155 0 0 1 0 -31.831"
              pathLength="100"
          />
          <!-- Progress Circle -->
          ${getChart(colors[ID]?.standart_ttk_percent,
  `<path id="progress-circle" class="progress" 
                  d="M18 2.0845a 15.9155 15.9155 0 0 1 0 31.831
                     a 15.9155 15.9155 0 0 1 0 -31.831"
                  pathLength="100" />`,
  '#0059A7'
)}
      </svg>                
          </div>    
         <div class="info-text">
         <p>Standart TTK:</p>
         <span class="male-color">${colors[ID].standart_ttk_percent}%</span>
         </div>
          </div>
      </div>

  </div>
  <div class="map-details-statistic-main-bycity">
 ${colors[ID].cities.map(item => {
            return `
      <div class="map-details-statistic-each-bycity">
          <span>${item.title.toUpperCase()}</span>
          <div>
          <div>
         <div>
         <h3>${item.male_value}</h3>
         <img src="./frq-templates/assets/img/xerite/menicon.svg" alt="">
         </div>
             <div class="info-text">
             <p>Kişi:</p>
             <span>${item.male_percent}%</span>
           
             </div>
          </div>    
        <div>
       <div >
       <h3>${item.female_value}</h3>
       <img src="./frq-templates/assets/img/xerite/womenicon.svg" alt="">
       </div>
       
         <div class="info-text">
         <p>Qadın:</p>
         <span>${item.female_percent}%</span>
         </div>
         </div>
        <div>
        <div>
        <h3>${item.sosial_ttk_value}</h3>
        <svg width="400px" viewBox="0 0 40 40" class="circular-chart">
        <!-- Background Circle -->
        <path
            class="background"
            d="M18 2.0845
               a 15.9155 15.9155 0 0 1 0 31.831
               a 15.9155 15.9155 0 0 1 0 -31.831"
            pathLength="100"
        />
        <!-- Progress Circle -->
        ${getChart(item?.sosial_ttk_percent,
`<path id="progress-circle" class="progress" 
                d="M18 2.0845a 15.9155 15.9155 0 0 1 0 31.831
                   a 15.9155 15.9155 0 0 1 0 -31.831"
                pathLength="100" />`,
'#E73B8E'
)}
    </svg>        </div>
 
       <div class="info-text">
       <p>Sosial TTK:</p>
       <span>${item.sosial_ttk_percent}%</span>
       </div>
             
        </div>  
       <div>
       <div>
       <h3>${item.standart_ttk_value}</h3>
       <svg width="400px" viewBox="0 0 40 40" class="circular-chart">
       <!-- Background Circle -->
       <path
           class="background"
           d="M18 2.0845
              a 15.9155 15.9155 0 0 1 0 31.831
              a 15.9155 15.9155 0 0 1 0 -31.831"
           pathLength="100"
       />
       <!-- Progress Circle -->
       ${getChart(item?.standart_ttk_percent,
`<path id="progress-circle" class="progress" 
               d="M18 2.0845a 15.9155 15.9155 0 0 1 0 31.831
                  a 15.9155 15.9155 0 0 1 0 -31.831"
               pathLength="100" />`,
'#0059A7'
)}
   </svg>            </div>
              <div class="info-text">
              <p>Standart TTK:</p>

              <span>${item.standart_ttk_percent}%</span>
             
              </div>
       </div>
          </div>
  </div>`
        }).join('')}      </div>

  `
        detailsOverlay.classList.add('show');
        detailsOverlay.style.display = 'flex';
        adjustCityDivWidth()

    }

    detailsOverlay.addEventListener('click', (event) => {
        if (event.target === detailsOverlay) {
            detailsOverlay.classList.remove('show');

        }
    });

    document.querySelector(".close-details-map").addEventListener("click", () => {
        detailsOverlay.classList.remove('show');
        resetElement(Array.from(svgDoc.querySelectorAll('.clickable-area')).filter(area => area.style))
    });
});


function adjustCityDivWidth() {
    const mainDiv = document.querySelector('.map-details-statistic-main-bycity');
    if (!mainDiv) return;

    const mainDivHeight = mainDiv.offsetHeight;
    const cityDivs = document.querySelectorAll('.map-details-statistic-each-bycity');

    const breakpoint = window.innerWidth < 768 ? 200 : 407;
    const newWidth = mainDivHeight > breakpoint ? '99%' : '100%';

    cityDivs.forEach(div => {
        div.style.width = newWidth;
    });
}

document.querySelectorAll('.details-modal').forEach(modal => {
    modal.addEventListener('show.bs.modal', adjustCityDivWidth);
});

window.addEventListener('resize', adjustCityDivWidth);




function getChart(paramPercent, pathString, color) {
    const tempContainer = document.createElement('div');
    tempContainer.innerHTML = pathString.trim();

    const $progressCircle = tempContainer.querySelector('#progress-circle');

    if (!$progressCircle) {
        console.error('Path element with id "progress-circle" not found.');
        return '';
    }

    const percent = paramPercent;  
    const radius = 15.9155; 
    const circumference = 2 * Math.PI * radius;

    let dashArray, gapArray;

    if (percent <= 50) {
        dashArray = (percent * circumference) / 100;
        gapArray = circumference - dashArray;
    } else {
        gapArray = ((100 - percent) * circumference) / 100;
        dashArray = circumference - gapArray;
    }

    $progressCircle.setAttribute('stroke-dasharray', `${dashArray} ${gapArray}`);
    $progressCircle.setAttribute('stroke', color);

    return $progressCircle.outerHTML;
}

